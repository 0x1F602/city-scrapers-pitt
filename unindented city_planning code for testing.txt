
pipenv shell
scrapy shell "http://pittsburghpa.gov/dcp/notices"

import re
import datetime

everything = response.css('div.col-md-12').extract()[0]
title_index = [m.start() for m in re.finditer('<p><strong>', everything)]
events = []
for i in range(0, len(title_index) - 1):
	start = title_index[i]
	# for the last event, need to make the end point just the end of everything
	if i == len(title_index) - 1:
		end = len(everything) - len('<p><strong>')
	else:
		end = title_index[i + 1] - len('<p><strong>')
	events.append(everything[start:end])

for item in events:
	
	item2=item.replace(u'\xa0',u' ')
	date_text=re.search('<li>.*?: (.*?)</li>',item2).group(1)
	# check if the word "at" is in date_text, to see if time is specified
	date_text=date_text.replace(' at ',' ')
	#remove commas since those aren't consistently used
	date_text=date_text.replace(',','')
	try:
            date = datetime.strptime(date_text, '%A %B %d %Y %I:%M %p')
	except ValueError:
		try:
			date = datetime.strptime(date_text '%A %B %d, %Y %I %p')
		except ValueError:
                	date = datetime.datetime(1111, 11, 11)
	print(date)